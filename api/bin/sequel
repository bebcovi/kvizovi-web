#!/usr/bin/env ruby

require "bundler/setup"

bin_sequel = Gem.bin_path('sequel', 'sequel')

case ARGV.first
when "migrate"
  Process.waitpid fork {
    ARGV.replace %W[-m db/migrations -M 0 config/database.yml]
    load bin_sequel
  }
  Process.waitpid fork {
    ARGV.replace %W[-m db/migrations config/database.yml]
    load bin_sequel
  }
when "console"
  ARGV.clear
  require "kvizovi"
  require "pry"
  Pry.start
else
  load bin_sequel
end
